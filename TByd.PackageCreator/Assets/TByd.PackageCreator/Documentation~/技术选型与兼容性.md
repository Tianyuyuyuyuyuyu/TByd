# TByd.PackageCreator 技术选型与兼容性策略

## 一、第三方库与工具评估

### 1.1 技术选型决策

经过评估，TByd.PackageCreator 工具**不需要**引入额外的第三方库，基于以下考虑：

- **自给自足原则**：作为包创建工具，应保持独立性，减少外部依赖
- **性能优化**：避免额外依赖可减少编译时间和包体积
- **兼容性保障**：第三方库可能引入额外的兼容性问题
- **简化维护**：减少依赖管理的复杂性和升级风险
- **文件操作安全**：使用 Unity 内置的安全 API 执行文件操作

### 1.2 Unity 内置功能使用

本工具将充分利用以下 Unity 内置功能和 API：

- **AssetDatabase**：用于资源管理和操作
- **EditorGUILayout**：用于编辑器 UI 构建
- **EditorPrefs**：用于保存用户配置
- **EditorWindow**：用于创建自定义编辑器窗口
- **JsonUtility**：用于 JSON 数据处理
- **Directory/File 操作**：用于文件系统操作（配合安全性检查）

### 1.3 未来可能的依赖考虑

如果未来功能扩展需要考虑引入第三方库，将基于以下标准评估：

- 是否为解决特定问题的唯一方案
- 库的维护状态和社区支持度
- 对包大小和性能的影响
- 许可证兼容性
- 跨 Unity 版本的兼容性表现

## 二、跨版本兼容性策略

### 2.1 目标兼容性范围

- **主要目标版本**：Unity 2021.3.8f1 LTS 及以上版本
- **次要支持版本**：Unity 2020.3 LTS（有限支持）
- **不支持版本**：Unity 2019.4 及更早版本

### 2.2 兼容性实现方法

#### 2.2.1 条件编译指令策略

将使用条件编译指令隔离版本特定代码：

```csharp
#if UNITY_2020_3_OR_NEWER
    // 2020.3+ 特定代码
#elif UNITY_2021_3_OR_NEWER
    // 2021.3+ 特定代码
#endif
```

#### 2.2.2 适配器模式实现

创建 `UnityVersionAdapter` 类，封装版本差异：

```csharp
public static class UnityVersionAdapter
{
    public static void ExecuteAssetDatabaseOperation(Action<bool> operation, bool synchronous)
    {
#if UNITY_2020_1_OR_NEWER
        AssetDatabase.SaveAssetIfDirty(asset);
#else
        // 旧版兼容操作
#endif
    }
}
```

#### 2.2.3 功能降级策略

- 在不支持某些新 API 的旧版本上，提供功能降级方案
- 明确记录每个功能的版本兼容范围
- 使用运行时检测提供友好错误信息

### 2.3 测试策略

- 在目标支持的所有 Unity 版本上进行自动化测试
- 建立版本兼容性测试矩阵
- 对版本特定功能进行单独标记和测试

### 2.4 文档规范

- 清晰标记 API 的版本兼容性要求
- 提供特定版本的安装和使用指南
- 维护已知版本特定问题列表

## 三、版本升级与维护计划

### 3.1 Unity 新版本发布响应

- 新的 Unity LTS 版本发布后两周内进行兼容性测试
- 确保主要功能在新版本上正常工作
- 必要时发布兼容性补丁

### 3.2 版本淘汰计划

- 每年评估一次支持的最低版本
- 提前 6 个月公告计划停止支持的版本
- 为用户提供升级路径指南

### 3.3 API 兼容性承诺

- 遵循语义化版本控制 (SemVer)
- 主版本更新可能包含破坏性变更
- 次版本和补丁版本保持向后兼容性
